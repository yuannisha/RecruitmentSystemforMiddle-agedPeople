{"version":3,"file":"list.js","sources":["pages/favorite/list.vue","E:/HBuilderX/HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZmF2b3JpdGUvbGlzdC52dWU"],"sourcesContent":["<!--\r\n * @description 收藏列表页面\r\n -->\r\n<template>\r\n\t<view class=\"favorite-container\">\r\n\t\t<!-- 未登录状态 -->\r\n\t\t<view class=\"login-tip\" v-if=\"!userInfo\">\r\n\t\t\t<text>请先登录</text>\r\n\t\t\t<button class=\"login-btn\" @click=\"goToLogin\">去登录</button>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 已登录状态 -->\r\n\t\t<block v-else>\r\n\t\t\t<view class=\"job-list\">\r\n\t\t\t\t<view \r\n\t\t\t\t\tclass=\"job-item\"\r\n\t\t\t\t\tv-for=\"job in favoriteList\"\r\n\t\t\t\t\t:key=\"job._id\"\r\n\t\t\t\t\t@click=\"goToJobDetail(job._id)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<view class=\"job-header\">\r\n\t\t\t\t\t\t<text class=\"job-title\">{{ job.title }}</text>\r\n\t\t\t\t\t\t<text class=\"job-salary\">{{ job.salary }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"company-info\">\r\n\t\t\t\t\t\t<text class=\"company-name\">{{ job.companyName }}</text>\r\n\t\t\t\t\t\t<text class=\"job-location\">{{ job.location }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"job-tags\">\r\n\t\t\t\t\t\t<text class=\"tag\" v-for=\"(tag, index) in job.tags\" :key=\"index\">{{ tag }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<view class=\"job-footer\">\r\n\t\t\t\t\t\t<text class=\"post-time\">{{ formatTime(job.createTime) }}</text>\r\n\t\t\t\t\t\t<button class=\"unfavorite-btn\" @click.stop=\"handleUnfavorite(job._id)\">取消收藏</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 加载更多 -->\r\n\t\t\t<view class=\"load-more\" v-if=\"hasMore\" @click=\"loadMore\">\r\n\t\t\t\t<text>加载更多</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"no-more\" v-else>\r\n\t\t\t\t<text>没有更多了</text>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<!-- 空状态 -->\r\n\t\t\t<view class=\"empty-state\" v-if=\"favoriteList.length === 0\">\r\n\t\t\t\t<text>暂无收藏</text>\r\n\t\t\t</view>\r\n\t\t</block>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tuserInfo: null,\r\n\t\t\tfavoriteList: [],\r\n\t\t\tpage: 1,\r\n\t\t\tpageSize: 10,\r\n\t\t\thasMore: true\r\n\t\t}\r\n\t},\r\n\tonShow() {\r\n\t\tthis.userInfo = uni.getStorageSync('userInfo')\r\n\t\tif (this.userInfo) {\r\n\t\t\tthis.resetList()\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tresetList() {\r\n\t\t\tthis.page = 1\r\n\t\t\tthis.favoriteList = []\r\n\t\t\tthis.hasMore = true\r\n\t\t\tthis.loadFavoriteList()\r\n\t\t},\r\n\t\t\r\n\t\tasync loadFavoriteList(loadMore = false) {\r\n\t\t\tif (!this.userInfo) return\r\n\t\t\t\r\n\t\t\tif (!loadMore) {\r\n\t\t\t\tthis.page = 1\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuni.showLoading({\r\n\t\t\t\ttitle: '加载中...'\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await uniCloud.callFunction({\r\n\t\t\t\t\tname: 'messageCenter',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'getFavoriteList',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tuserId: this.userInfo.userId,\r\n\t\t\t\t\t\t\tpage: this.page,\r\n\t\t\t\t\t\t\tpageSize: this.pageSize\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (result.result.code === 0) {\r\n\t\t\t\t\tconst { list, total } = result.result.data\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (loadMore) {\r\n\t\t\t\t\t\tthis.favoriteList = [...this.favoriteList, ...list]\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.favoriteList = list\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.hasMore = this.favoriteList.length < total\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: result.result.msg,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '加载失败，请重试',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t} finally {\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tloadMore() {\r\n\t\t\tif (this.hasMore) {\r\n\t\t\t\tthis.page++\r\n\t\t\t\tthis.loadFavoriteList(true)\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tasync handleUnfavorite(jobId) {\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await uniCloud.callFunction({\r\n\t\t\t\t\tname: 'messageCenter',\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\taction: 'removeFavorite',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tuserId: this.userInfo.userId,\r\n\t\t\t\t\t\t\tjobId\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tif (result.result.code === 0) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '取消收藏成功'\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// 从列表中移除\r\n\t\t\t\t\tthis.favoriteList = this.favoriteList.filter(job => job._id !== jobId)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: result.result.msg,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '操作失败，请重试',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tgoToJobDetail(jobId) {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: `/pages/job/detail?id=${jobId}`\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\tgoToLogin() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/login/login'\r\n\t\t\t})\r\n\t\t},\r\n\t\t\r\n\t\tformatTime(timestamp) {\r\n\t\t\tconst date = new Date(timestamp)\r\n\t\t\tconst now = new Date()\r\n\t\t\t\r\n\t\t\t// 如果是今天发布的，只显示时间\r\n\t\t\tif (date.toDateString() === now.toDateString()) {\r\n\t\t\t\treturn `${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 如果是昨天发布的，显示\"昨天\"\r\n\t\t\tconst yesterday = new Date(now)\r\n\t\t\tyesterday.setDate(now.getDate() - 1)\r\n\t\t\tif (date.toDateString() === yesterday.toDateString()) {\r\n\t\t\t\treturn `昨天 ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// 其他日期显示完整日期\r\n\t\t\treturn `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style>\r\n.favorite-container {\r\n\tmin-height: 100vh;\r\n\tbackground-color: #f8f8f8;\r\n\tpadding: 20rpx;\r\n}\r\n\r\n.login-tip {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tpadding: 100rpx 0;\r\n}\r\n\r\n.login-tip text {\r\n\tfont-size: 32rpx;\r\n\tcolor: #666;\r\n\tmargin-bottom: 40rpx;\r\n}\r\n\r\n.login-btn {\r\n\twidth: 240rpx;\r\n\theight: 80rpx;\r\n\tbackground-color: #007AFF;\r\n\tcolor: #fff;\r\n\tborder-radius: 40rpx;\r\n\tfont-size: 32rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n}\r\n\r\n.job-list {\r\n\tmargin-bottom: 30rpx;\r\n}\r\n\r\n.job-item {\r\n\tbackground-color: #fff;\r\n\tborder-radius: 20rpx;\r\n\tpadding: 30rpx;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.job-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.job-title {\r\n\tfont-size: 32rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333;\r\n}\r\n\r\n.job-salary {\r\n\tfont-size: 32rpx;\r\n\tcolor: #ff4757;\r\n\tfont-weight: bold;\r\n}\r\n\r\n.company-info {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.company-name {\r\n\tfont-size: 28rpx;\r\n\tcolor: #666;\r\n}\r\n\r\n.job-location {\r\n\tfont-size: 26rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n.job-tags {\r\n\tdisplay: flex;\r\n\tflex-wrap: wrap;\r\n\tgap: 16rpx;\r\n\tmargin-bottom: 20rpx;\r\n}\r\n\r\n.tag {\r\n\tfont-size: 24rpx;\r\n\tcolor: #007AFF;\r\n\tbackground-color: rgba(0, 122, 255, 0.1);\r\n\tpadding: 8rpx 20rpx;\r\n\tborder-radius: 24rpx;\r\n}\r\n\r\n.job-footer {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n}\r\n\r\n.post-time {\r\n\tfont-size: 24rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n.unfavorite-btn {\r\n\tfont-size: 26rpx;\r\n\tcolor: #666;\r\n\tbackground-color: #f5f5f5;\r\n\tpadding: 10rpx 30rpx;\r\n\tborder-radius: 30rpx;\r\n}\r\n\r\n.load-more, .no-more {\r\n\ttext-align: center;\r\n\tpadding: 30rpx 0;\r\n}\r\n\r\n.load-more text, .no-more text {\r\n\tfont-size: 26rpx;\r\n\tcolor: #999;\r\n}\r\n\r\n.empty-state {\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\theight: 400rpx;\r\n}\r\n\r\n.empty-state text {\r\n\tfont-size: 28rpx;\r\n\tcolor: #999;\r\n}\r\n</style> ","import MiniProgramPage from 'D:/programs2024to2025/yangmenglianprogram/fifth/RecruitmentSystemforMiddle-agedPeople/pages/favorite/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","uniCloud"],"mappings":"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"}